getwd()
clinic <- clinic.csv
setwd("/Users/minwoocho/Desktop/qbio_data_analysis_minwooc/")
clinic <- "clinic.csv"
clinic <- read.csv("./analysis_data/GDCdata/TCGA-COAD/harmonized/Clinical")
library(TCGAbiolinks)
clin_query <- GDCquery(project = "TCGA-COAD", data.category = "Clinical", file.type = "xml")
clinic <- GDCprepare_clinic(clin_query, clinical.info = "patient")
# Just adding an underscore between follow and up
names(clinic)[names(clinic)=="days_to_last_followup"] <- "days_to_last_follow_up"
colnames(clinic)
clinic_copy <- clinic
View(clinic_copy)
mean(clinic_copy$age_at_initial_pathologic_diagnosis)
young_old <- ifelse(clinic_copy$age_at_initial_pathologic_diagnosis>=67.83, TRUE, FALSE)
boxplot(clinic_copy$age_at_initial_pathologic_diagnosis, young_old)
hist(young_old)
barplot(young_old)
is.na(clinic_copy$days_to_birth)
is.na(sum(clinic_copy$days_to_birth))
sum(na_age)
sum("na_age")
sum(na_age)
sum(na_age)
na_age <- is.na(clinic_copy$days_to_birth)
sum(na_age)
clinic$age_category <- ifelse(clinic_copy$age_at_initial_pathologic_diagnosis>=67.83, TRUE, FALSE)
clinic_copy$age_category <- ifelse(clinic_copy$age_at_initial_pathologic_diagnosis>=67.83, TRUE, FALSE)
source("~/Desktop/qbio_data_analysis_minwooc/Week 5 hw 1.R")
# 2.3
dim(colData(sum_exp))
dim(rowData(sum_exp))
dim(assays(sum_exp)$"HTSeq - Counts")
#2.4
str(colData(sum_exp))
# 2.3
dim(colData(sum_exp))
dim(rowData(sum_exp))
dim(assays(sum_exp)$"HTSeq - Counts")
# 2.5
str(colData(sum_exp))
# 2.5
colnames(colData(sum_exp))
sum_exp$age_at_diagnosis[1:10]
colData(sum_exp)$age_at_diagnosis[1:10]
colData(sum_exp$age_at_diagnosis) / 365 = colData(sum_exp$age_at_diagnosis)
colData(sum_exp$age_at_diagnosis) / 365
colData(sum_exp$age_at_diagnosis) <- colData(sum_exp$age_at_diagnosis) / 365
colData(sum_exp$age_at_diagnosis)/365
as.numeric(colData(sum_exp$age_at_diagnosis))/365
# 2.5
colnames(colData(sum_exp))
colData(sum_exp)$age_at_diagnosis[1:10]
colData(sum_exp)$age_at_diagnosis
colData(sum_exp$age_at_diagnosis) <- colData(sum_exp$age_at_diagnosis / 365)
colData(sum_exp$age_at_diagnosis) <- colData(sum_exp$age_at_diagnosis)/365
colData(sum_exp$age_at_diagnosis) <- colData(sum_exp$age_at_diagnosis) % 365
colData(sum_exp$age_at_diagnosis) <- as.numeric(colData(sum_exp$age_at_diagnosis)) / 365
View(sum_exp)
sum_exp_copy <- sum_exp
is.na(sum_exp_copy) <- 0
rm(sum_exp_copy)
sum_exp_copy <- sum_exp
is.na(sum_exp_copy$age_at_diagnosis)
is.na(sum_exp_copy$age_at_diagnosis) <- 0
sum_exp_copy$age_at_diagnosis
is.na(sum_exp_copy$age_at_diagnosis) <- 0
sum_exp_copy$age_at_diagnosis
colData(sum_exp$age_at_diagnosis) <- colData(sum_exp$age_at_diagnosis) / 365
is.na(sum_exp_copy$age_at_diagnosis) <- 0
sum_exp_copy$age_at_diagnosis
# 2.2
head(rowData(sum_exp_copy))
dim(rowData(sum_exp_copy))
dim(rowData(sum_exp))
KRAS %in% rowData(sum_exp_copy)
FGR %in% rowData(sum_exp_copy)
KRAS %in% rowData(sum_exp_copy)
KRAS %in% rowData(sum_exp$external_gene_name)
colnames(rowData(sum_exp))
str(rowData(sum_exp))
dim(rowData(sum_exp_copy))
View(sum_exp_copy)
View(sum_exp)
rowData(sum_exp$external_gene_name)
# 2.2
head(rowData(sum_exp_copy))
colNames(rowData(sum_exp))
colnames(rowData(sum_exp))
rowData(sum_exp)$external_gene_name
"KRAS" %in% rowData(sum_exp)$external_gene_name
"FGR" %in% rowData(sum_exp$external_gene_name)
"FGR" %in% rowData(sum_exp)$external_gene_name
sum_exp_copy$age_at_diagnosis <- sum_exp_copy$age_at_diagnosis / 365
sum_exp_copy$age_at_diagnosis
sum_exp_copy$age_category <- ifelse(sum_exp_copy>=50, "Old", "Young")
sum_exp_copy$age_category <- ifelse(sum_exp_copy$age_at_diagnosis>=50, "Old", "Young")
sum_exp_copy$age_category
# 2.3
assays(sum_exp)$"HTSeq - Counts"[20:25, 30:35]
geneA_id_mask <- rowData(sum_exp_copy)$external_gene_name
geneA_id_mask <- rowData(sum_exp_copy)$external_gene_name == "KRAS"
sum(geneA_id_mask)
ensembl_geneA <- rowData(sum_exp_copy)$external_gene_name[geneA_id_mask]
ensembl_geneA <- rowData(sum_exp_copy)$ensembl_gene_id[geneA_id_mask]
ensembl_geneA <- rowData(sum_exp_copy$ensembl_gene_id)[geneA_id_mask]
geneB_id_mask <- rowData(sum_exp_copy)$external_gene_name == "FGR"
sum(geneB_id_mask)
ensembl_geneB <- rowData(sum_exp_copy)$ensembl_gene_id[geneB_id_mask]
?min()
min(assays(sum_exp)$"HTSeq - Counts"[rowData(sum_exp_copy)$external_gene_name, ensembl_geneA])
min(assays(sum_exp)$"HTSeq - Counts"[ , ensembl_geneA])
min(assays(sum_exp)$"HTSeq - Counts"[ensembl_geneA, ])
max(assays(sum_exp)$"HTSeq - Counts"[ensembl_geneA, ])
summary(assays(sum_exp)$"HTSeq - Counts"[ensembl_geneB, ])
data_for_geneA <- assays(sum_exp_copy)$"HTSeq - Counts"[ensemble_geneA, ]
data_for_geneA <- assays(sum_exp_copy)$"HTSeq - Counts"[ensembl_geneA, ]
data_for_geneB <- assays(sum_exp_copy)$"HTSeq - Counts"[ensembl_geneB, ]
plot(data_for_geneA,
data_for_geneB,
xlab = "KRAS",
ylab = "FGR"
)
bool_age_na <- is.na(colData(sum_exp_copy$age_category)
sum(bool_age_na)
bool_age_na <- is.na(colData(sum_exp_copy$age_category))
bool_age_na <- is.na(colData(sum_exp_copy)$age_category)
num_na <- sum(bool_age_na)
num_na
age_cat_no_NAs != bool_age_na
age_cat_no_NAs = !bool_age_na
length(assays(sum_exp_copy)$"HTSeq - Counts"[age_cat_no_NAs, ])
num_na
colData(sum_exp_copy)
num_na
bool_age_na
length(assays(sum_exp_copy)$"HTSeq - Counts"[age_cat_no_NAs, ])
dim(colData(sum_exp_copy))
age_cat_no_NAs
length(assays(sum_exp_copy)$"HTSeq - Counts"[age_cat_no_NAs])
dim(assays(sum_exp_copy)$"HTSeq - Counts")
dim(age_cat_no_NAs)
length(age_cat_no_NAs)
num_na
dim(sum_exp_copy)
age_cat_no_NAs = bool_age_na!
length(assays(sum_exp_copy)$"HTSeq - Counts"[age_cat_no_NAs])
age_cat_no_NAs = !bool_age_na
length(age_cat_no_NAs)
length(bool_age_na)
sum(age_cat_no_NAs)
sum(age_cat_no_NAs)
dim(sum_exp_copy)
colData(sum_exp_copy)
colnames(sum_exp_copy)
age_cat_no_NAs
sum(age_cat_no_NAs)
sum(bool_age_na)
dim(sum_exp_copy)
dim(assays(sum_exp_copy)$"HTSeq - Counts")
sum(age_cat_no_NAs)
dim(colData(sum_exp_copy))
identical((rownames(colData(sum_exp_copy))), colnames(assays(sum_exp_copy)"$HTSeq - Counts"))
identical((rownames(colData(sum_exp_copy))), colnames(assays(sum_exp_copy)$"HTSeq - Counts"))
gene_counts = dataframe[bool_age_na, ensembl_geneA]
